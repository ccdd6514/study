{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["interface EventFace {\r\n  on: (name: string, fn: Function) => void\r\n  emit: (name: string, ...args: Array<any>) => void\r\n  off: (name: string, fn: Function) => void\r\n  once: (name: string, fn: Function) => void\r\n}\r\n\r\ninterface List {\r\n  [key: string]: Array<Function>\r\n}\r\n\r\nclass Dispatch implements EventFace {\r\n  list: List\r\n  constructor() {\r\n    this.list = {}\r\n  }\r\n  on(name: string, fn: Function) {\r\n    const callback = this.list[name] || []\r\n    callback.push(fn)\r\n    this.list[name] = callback\r\n  }\r\n  emit(name: string, ...args: Array<any>) {\r\n    let eventName = this.list[name]\r\n    if (name === 'post2') {\r\n      console.log(eventName)\r\n    }\r\n    if (eventName) {\r\n      eventName.forEach((fn) => {\r\n        fn.apply(this, args)\r\n      })\r\n    } else {\r\n      console.error('名称错误' + name)\r\n    }\r\n  }\r\n  off(name: string, fn: Function) {\r\n    let eventName = this.list[name]\r\n    if (eventName && fn) {\r\n      let index = eventName.findIndex((fns) => fns === fn)\r\n      eventName.splice(index, 1)\r\n    } else {\r\n      console.error('名称错误' + name)\r\n    }\r\n  }\r\n  once(name: string, fn: Function) {\r\n    let de = (...args: Array<any>) => {\r\n      fn.apply(this, args)\r\n      this.off(name, de)\r\n    }\r\n    this.on(name, de)\r\n  }\r\n}\r\n\r\nconst o = new Dispatch()\r\n\r\no.on('post', (...args) => {\r\n  console.log(1, args)\r\n})\r\n\r\no.emit('post', 1, false, { name: 'xy' })\r\n\r\nconst fn = (...args: Array<any>) => {\r\n  console.log(2, 'off', args)\r\n}\r\no.on('post1', fn)\r\no.emit('post1', 2, true, { name: 'xy' })\r\no.off('post1', fn)\r\n\r\nconst fn1 = (...args: Array<any>) => {\r\n  console.log(2, 'once', args)\r\n}\r\no.once('post2', fn1)\r\no.emit('post2', 2, true, { name: 'xy1' })\r\no.emit('post2', 3, true, { name: 'xy2' })\r\no.emit('post2', 4, true, { name: 'xy3' })\r\nconsole.log(o.list)\r\n"],"names":["o","constructor","this","list","on","name","fn","callback","push","emit","args","eventName","console","log","forEach","apply","error","off","index","findIndex","fns","splice","once","de"],"mappings":"gXAoDA,MAAMA,EAAI,IAzCV,MAEEC,cACEC,KAAKC,KAAO,GAEdC,GAAGC,EAAcC,GACf,MAAMC,EAAWL,KAAKC,KAAKE,IAAS,GACpCE,EAASC,KAAKF,GACdJ,KAAKC,KAAKE,GAAQE,EAEpBE,KAAKJ,KAAiBK,GACpB,IAAIC,EAAYT,KAAKC,KAAKE,GACb,UAATA,GACFO,QAAQC,IAAIF,GAEVA,EACFA,EAAUG,SAASR,IACjBA,EAAGS,MAAMb,KAAMQ,EAAK,IAGtBE,QAAQI,MAAM,OAASX,GAG3BY,IAAIZ,EAAcC,GAChB,IAAIK,EAAYT,KAAKC,KAAKE,GAC1B,GAAIM,GAAaL,EAAI,CACnB,IAAIY,EAAQP,EAAUQ,WAAWC,GAAQA,IAAQd,IACjDK,EAAUU,OAAOH,EAAO,QAExBN,QAAQI,MAAM,OAASX,GAG3BiB,KAAKjB,EAAcC,GACjB,IAAIiB,EAAK,IAAIb,KACXJ,EAAGS,MAAMb,KAAMQ,GACfR,KAAKe,IAAIZ,EAAMkB,EAAG,EAEpBrB,KAAKE,GAAGC,EAAMkB,KAMlBvB,EAAEI,GAAG,QAAQ,IAAIM,KACfE,QAAQC,IAAI,EAAGH,EAAK,IAGtBV,EAAES,KAAK,OAAQ,GAAG,EAAO,CAAEJ,KAAM,OAEjC,MAAMC,EAAK,IAAII,KACbE,QAAQC,IAAI,EAAG,MAAOH,EAAK,EAE7BV,EAAEI,GAAG,QAASE,GACdN,EAAES,KAAK,QAAS,GAAG,EAAM,CAAEJ,KAAM,OACjCL,EAAEiB,IAAI,QAASX,GAKfN,EAAEsB,KAAK,SAHK,IAAIZ,KACdE,QAAQC,IAAI,EAAG,OAAQH,EAAK,IAG9BV,EAAES,KAAK,QAAS,GAAG,EAAM,CAAEJ,KAAM,QACjCL,EAAES,KAAK,QAAS,GAAG,EAAM,CAAEJ,KAAM,QACjCL,EAAES,KAAK,QAAS,GAAG,EAAM,CAAEJ,KAAM,QACjCO,QAAQC,IAAIb,EAAEG"}